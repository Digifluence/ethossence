<<<<<<< HEAD
<pre>v 16</pre>

=======
>>>>>>> 87ba690de1065243f8a02ae19e783b4c9968f305
{{ 'ethossence-image-gallery.css' | asset_url | stylesheet_tag }}

{%- style -%}
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
  }

  @media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }
{%- endstyle -%}

{%- liquid
  assign gallery_images = product.metafields.ethossence.collection_img_file.value
  assign desktop_columns = section.settings.desktop_columns
  assign mobile_columns = section.settings.mobile_columns
-%}

{%- if gallery_images != blank -%}
  <image-gallery class="image-gallery section-{{ section.id }}-padding color-{{ section.settings.color_scheme }} gradient" data-gallery-id="{{ section.id }}">
    <div class="image-gallery__wrapper page-width">
      {%- if section.settings.title != blank -%}
        <div class="title-wrapper-with-link title-wrapper--self-padded-mobile title-wrapper--no-top-margin">
          <h2 class="title inline-richtext {{ section.settings.heading_size }}">
            {{ section.settings.title }}
          </h2>
        </div>
      {%- endif -%}
    </div>

    <div 
      class="image-gallery__grid grid grid--{{ desktop_columns }}-col-desktop grid--{{ mobile_columns }}-col-tablet-down page-width"
    >
      {%- for image in gallery_images -%}
        <div class="image-gallery__item grid__item">
          <button
            type="button"
            class="image-gallery__trigger"
            data-gallery-trigger
            data-image-index="{{ forloop.index0 }}"
            aria-label="{{ 'products.product.media.open_media' | t: index: forloop.index }}"
          >
            <div class="image-gallery__image-wrapper">
              {{
                image
                | image_url: width: 800
                | image_tag:
                  loading: 'lazy',
                  class: 'image-gallery__image',
                  widths: '375, 550, 750, 1100, 1500',
                  sizes: '(min-width: 750px) calc((100vw - 10rem) / ' | append: desktop_columns | append: '), calc((100vw - 3rem) / ' | append: mobile_columns | append: ')'
              }}
            </div>
          </button>
        </div>
      {%- endfor -%}
    </div>

    {%- comment -%} LIGHTBOX MODAL {%- endcomment -%}
    <div class="image-gallery-modal" data-gallery-modal aria-hidden="true" role="dialog" aria-modal="true">
      <div class="image-gallery-modal__overlay" data-gallery-close></div>
      
      <div class="image-gallery-modal__content">
        <button
          type="button"
          class="image-gallery-modal__close"
          data-gallery-close
          aria-label="{{ 'accessibility.close' | t }}"
        >
          {{- 'icon-close.svg' | inline_asset_content -}}
        </button>

        <button
          type="button"
          class="image-gallery-modal__nav image-gallery-modal__nav--prev"
          data-gallery-prev
          aria-label="{{ 'general.slider.previous_slide' | t }}"
        >
          {{- 'icon-caret.svg' | inline_asset_content -}}
        </button>

        <div class="image-gallery-modal__image-container">
          <img
            class="image-gallery-modal__image"
            data-gallery-image
            src=""
            alt=""
            loading="lazy"
          >
          <div class="image-gallery-modal__counter" data-gallery-counter></div>
        </div>

        <button
          type="button"
          class="image-gallery-modal__nav image-gallery-modal__nav--next"
          data-gallery-next
          aria-label="{{ 'general.slider.next_slide' | t }}"
        >
          {{- 'icon-caret.svg' | inline_asset_content -}}
        </button>
      </div>
    </div>

    {%- comment -%} GALLERY DATA FOR JAVASCRIPT {%- endcomment -%}
    <script type="application/json" data-gallery-data="{{ section.id }}">
      [
        {%- for image in gallery_images -%}
          {
            "url": {{ image | image_url: width: 2048 | json }},
            "alt": {{ image.alt | default: 'Gallery image' | json }},
            "width": {{ image.width | json }},
            "height": {{ image.height | json }}
          }{% unless forloop.last %},{% endunless %}
        {%- endfor -%}
      ]
    </script>
  </image-gallery>

  <script src="{{ 'ethossence-image-gallery.js' | asset_url }}" defer="defer"></script>
{%- endif -%}

{% schema %}
{
  "name": "Image gallery",
  "tag": "section",
  "class": "section",
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [
    {
      "type": "inline_richtext",
      "id": "title",
      "default": "Image Gallery",
      "label": "Heading"
    },
    {
      "type": "select",
      "id": "heading_size",
      "options": [
        {
          "value": "h2",
          "label": "Small"
        },
        {
          "value": "h1",
          "label": "Medium"
        },
        {
          "value": "h0",
          "label": "Large"
        }
      ],
      "default": "h1",
      "label": "Heading size"
    },
    {
      "type": "range",
      "id": "desktop_columns",
      "min": 1,
      "max": 6,
      "step": 1,
      "default": 4,
      "label": "Number of columns on desktop"
    },
    {
      "type": "range",
      "id": "mobile_columns",
      "min": 1,
      "max": 3,
      "step": 1,
      "default": 2,
      "label": "Number of columns on mobile"
    },
    {
      "type": "header",
      "content": "Section padding"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Top padding",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Bottom padding",
      "default": 36
    }
  ],
  "presets": [
    {
      "name": "Image gallery"
    }
  ]
}
{% endschema %}
